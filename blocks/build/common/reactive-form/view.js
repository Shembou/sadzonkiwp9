(()=>{"use strict";class e{async submitReactiveForm(e){try{const t=await fetch("/wp-json/blocks/v1/contact-min",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw new Error(`Server error (${t.status}): ${e}`)}let s;try{s=await t.json()}catch(e){throw new Error("Invalid JSON response from server")}return s.error?(console.error("API error:",s.error),{success:!1,message:s.error}):(console.log("Success:",s),{success:!0,data:s})}catch(e){return console.error("Request failed:",e),{success:!1,message:e.message}}}async submitContactForm(e){try{const t=await fetch("/wp-json/blocks/v1/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw new Error(`Server error (${t.status}): ${e}`)}let s;try{s=await t.json()}catch(e){throw new Error("Invalid JSON response from server")}return s.error?(console.error("API error:",s.error),{success:!1,message:s.error}):(console.log("Success:",s),{success:!0,data:s})}catch(e){return console.error("Request failed:",e),{success:!1,message:e.message}}}}let t=!1,s={};function r(e,t){const r=document.querySelector(`[name="${e}"]`);return!!r&&(r.classList.remove("invalid"),r.setCustomValidity(""),r.checkValidity()?(s[e]=r.value.trim(),!0):(r.setCustomValidity(t),r.classList.add("invalid"),r.reportValidity(),!1))}document.addEventListener("DOMContentLoaded",()=>{const o=document.querySelector(".first-step"),a=document.querySelector(".second-step");o&&gsap.set(o,{x:"0%",opacity:1,display:"grid"}),a&&gsap.set(a,{x:"100%",opacity:0,display:"none"});const n=document.getElementById("next-step");n&&n.addEventListener("click",e=>{if(e.preventDefault(),!function(){const e=document.querySelector('textarea[name="text"]');return!!e&&(e.checkValidity()?(e.classList.contains("invalid")&&e.classList.remove("invalid"),s.text=e.value.trim(),!0):(e.classList.add("invalid"),e.reportValidity(),!1))}())return;t=!0,function(e,t,s=1){if(!e||!t)return;const r=e.parentElement,o=e.offsetHeight;t.style.display="grid";const a=t.offsetHeight;t.style.display="none",gsap.set(r,{height:o}),gsap.to(r,{height:a,duration:.5,ease:"power1.inOut"}),gsap.set(t,{x:100*s+"%",opacity:0,display:"grid"}),gsap.to(e,{x:100*-s+"%",opacity:0,duration:.2,onComplete:()=>{e.style.display="none"}}),gsap.to(t,{x:"0%",opacity:1,duration:.5,delay:.1})}(o,a,1);const r=a.querySelector("input[name='name']");r&&r.focus()});const c=document.querySelector("form.wp-block-common-reactive-form");c&&(function(e){const t=e.querySelectorAll("input,textarea");null!=t&&t.forEach(e=>{e.addEventListener("focus",()=>{e.classList.add("wasFocused","focused")}),e.addEventListener("blur",()=>{e.classList.remove("focused")})})}(c),c.addEventListener("submit",t=>{t.preventDefault(),r("mail","Proszę podać poprawny adres e-mail")&&r("name","Proszę podać poprawnę imię")&&function(){const e=document.querySelector('[name="privacy-policy"]');return!!e&&(e.classList.remove("invalid"),e.setCustomValidity(""),e.checked?(s["privacy-policy"]=e.checked,!0):(e.setCustomValidity("Do wysłania wiadomości wymagane jest potwierdzenie polityki prywatności"),e.reportValidity(),!1))}()&&(new e).submitReactiveForm(s).then(e=>{e.success?alert("Form submitted successfully!"):alert("Error: "+e.message)})}))})})();